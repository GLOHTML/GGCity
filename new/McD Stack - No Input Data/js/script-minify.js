var START_HOOK_ROT_SPEED,HOOK_ROT_INCREASE_FACTOR,HOOK_MAX_ROT,NUM_LEVELS,NUM_LIVES,FALL_SPEED,BEST_MULTIPLIER,MULTIPLIER_BONUS_POINT,ENABLE_FULLSCREEN,ENABLE_CHECK_ORIENTATION,CANVAS_WIDTH=1400,CANVAS_HEIGHT=1920,EDGEBOARD_X=160,EDGEBOARD_Y=160,FPS=30,FPS_TIME=1e3/FPS,DISABLE_SOUND_MOBILE=!1,FONT_GAME="upheaval_tt_brkregular",SOUNDTRACK_VOLUME_IN_GAME=.2,STATE_LOADING=0,STATE_INTRO=1,STATE_MENU=2,STATE_HELP=3,STATE_GAME=4,ON_MOUSE_DOWN=0,ON_MOUSE_UP=1,ON_MOUSE_OVER=2,ON_MOUSE_OUT=3,ON_DRAG_START=4,ON_DRAG_END=5,ON_CONTROLLER_END=6,ON_CONTROLLER_REMOVE=7,STATE_HOOK_ROTATE=0,STATE_BLOCK_ROTATE=1,STATE_BLOCK_FALLING=2,STATE_BLOCK_MISPLACED=3,STATE_SHOW_THE_TOWER=4,BG_HEIGHT=2185,FIRST_BLOCK_LANDING_Y=1735,HOOK_START_X=CANVAS_WIDTH/2,HOOK_START_Y=EDGEBOARD_Y+124,HOOK_THICKNESS=4,LINE_LENGTH=300,TIME_GROUND_MOVE=800,Y_OFFSET_CAMERA=CANVAS_HEIGHT/2+300,BONUS_TOLLERANCE=10,SPEED_TOWER_SHOWING=15,MAX_SCORE_PER_BLOCK=350,BIRD_SPEED=5e3,BIRD_OCCURRENCE=7e3;function CSpriteLibrary(){var e,t,i,n,a,s,o={};this.init=function(o,r,_){e={},t=0,i=0,n=o,a=r,s=_},this.addSprite=function(i,n){if(!o.hasOwnProperty(i)){var a=new Image;o[i]=e[i]={szPath:n,oSprite:a,bLoaded:!1},t++}},this.getSprite=function(e){return o.hasOwnProperty(e)?o[e].oSprite:null},this._onSpritesLoaded=function(){t=0,a.call(s)},this._onSpriteLoaded=function(){n.call(s),++i===t&&this._onSpritesLoaded()},this.loadSprites=function(){for(var t in e)e[t].oSprite.oSpriteLibrary=this,e[t].oSprite.szKey=t,e[t].oSprite.onload=function(){this.oSpriteLibrary.setLoaded(this.szKey),this.oSpriteLibrary._onSpriteLoaded(this.szKey)},e[t].oSprite.onerror=function(t){var i=t.currentTarget;setTimeout(function(){e[i.szKey].oSprite.src=e[i.szKey].szPath},500)},e[t].oSprite.src=e[t].szPath},this.setLoaded=function(e){o[e].bLoaded=!0},this.isLoaded=function(e){return o[e].bLoaded},this.getNumSprites=function(){return t}}function CBlock(e,t,i,n,a,s){var o,r,_,l,c,h,u,d,T;this._init=function(e,t,i,n,a,s){r=0,_=Math.floor(n/2),l=n,Math.floor(a/2),c=a,(h=new CVector2).set(0,1),T=s,u=i,(d=new createjs.Container).x=e,d.y=t,T.addChild(d),d.addChild(i),o=!0},this.unload=function(){T.removeChild(d)},this.setY=function(e){d.y=e},this.decreaseY=function(e){d.y-=e},this.scrollDownCamera=function(e){var t=d.y+e;createjs.Tween.get(d).to({y:t},TIME_GROUND_MOVE,createjs.Ease.cubicOut)},this.misplaced=function(e){d.x+=e,d.regX+=e,d.regY=c;var t=1;e>0&&(t=-1),o=!1;var i=this;createjs.Tween.get(d).to({rotation:60*t},510).call(function(){s_oGame.checkIfOtherBlocksFalling()}),createjs.Tween.get(d).to({y:CANVAS_HEIGHT+200},1e3,createjs.Ease.backInOut).call(function(){i.unload(),s_oGame.setBlock(!1)})},this.attachScore=function(e,t){var i,n;i="#FFFFFF",n="#000000";var a=new createjs.Text("+"+e,"50px "+FONT_GAME,n);a.alpha=0,a.outline=6,a.x=0,a.y=0,a.textAlign="center",a.textBaseline="alphabetic",d.addChild(a);var s=new createjs.Text("+"+e,"50px "+FONT_GAME,i);s.alpha=0,s.x=0,s.y=0,s.textAlign="center",s.textBaseline="alphabetic",d.addChild(s),createjs.Tween.get(a).to({alpha:1},500),createjs.Tween.get(a).to({y:-30},1500,createjs.Ease.cubicOut).call(function(){createjs.Tween.get(a).wait(300).to({alpha:0},300).call(function(){d.removeChild(a)})}),createjs.Tween.get(s).to({alpha:1},500),createjs.Tween.get(s).to({y:-30},1500,createjs.Ease.cubicOut).call(function(){createjs.Tween.get(s).wait(300).to({alpha:0},300).call(function(){d.removeChild(s)})})},this.getYBase=function(){return d.y+c},this.getX=function(){return d.x},this.getY=function(){return d.y},this.getWidth=function(){return l},this.getHalfWidth=function(){return _},this.getHeight=function(){return c},this.getRectangle=function(){return new createjs.Rectangle(d.x-_+20,d.y,l-20,c)},this.getSprite=function(){return u},this.updateRotation=function(e){d.x=e.x,d.y=e.y},this.updateFalling=function(e){!1!==o&&(r+=e,d.x+=r*h.getX(),d.y+=r*h.getY())},this._init(e,t,i,n,a,s)}function CBird(e,t,i,n){var a,s,o;this._init=function(e,t,i){a=i;var n={framerate:10,images:[s_oSpriteLibrary.getSprite("bird")],frames:{width:30,height:26},animations:{fly:[0,3,"fly"]}},r=new createjs.SpriteSheet(n);(s=createSprite(r,"fly",0,0,30,26)).x=e,s.y=t,s.scaleX=a,o.addChild(s);var _=this;createjs.Tween.get(s).to({x:e+a*(CANVAS_WIDTH+100)},BIRD_SPEED).call(function(){_.unload()})},this.unload=function(){o.removeChild(s)},o=n,this._init(e,t,i)}function CTLText(e,t,i,n,a,s,o,r,_,l,c,h,u,d,T,S,E){this._oContainer=e,this._x=t,this._y=i,this._iWidth=n,this._iHeight=a,this._bMultiline=S,this._iFontSize=s,this._szAlign=o,this._szColor=r,this._szFont=_,this._iPaddingH=c,this._iPaddingV=h,this._bVerticalAlign=T,this._bFitText=d,this._bDebug=E,this._oDebugShape=null,this._fLineHeightFactor=l,this._oText=null,u&&this.__createText(u)}function CGame(e){var t,i,n,a,s,o,r,_,l,c,h,u,d,T,S,E,p,g,f,A,C,O,L,w,b,x,y,N,I,m,v,H,R=!1,B=null;function F(e){switch(e||(e=window.event),e.keyCode){case 32:t?!R&&b.isVisible()?b.onButPlayAgainRelease():!R&&x.isVisible()&&x.onButRestartRelease():a=STATE_BLOCK_FALLING}return e.preventDefault(),!1}this._init=function(e){i=1,_=0,T=0,n=NUM_LIVES,new CGameSettings(e),S=s_aHookSpeed[i-1],(N=new createjs.Container).y=CANVAS_HEIGHT-BG_HEIGHT,s_oStage.addChild(N);var t=s_oSpriteLibrary.getSprite("crane");(L=createBitmap(t)).x=CANVAS_WIDTH-t.width,L.y=EDGEBOARD_Y+60,s_oStage.addChild(L),w=new CHook,m=new createjs.Container,s_oStage.addChild(m),I=new createjs.Container,s_oStage.addChild(I),O=new CGfxButton(CANVAS_WIDTH/2,CANVAS_HEIGHT/2,s_oSpriteLibrary.getSprite("hit_area"),s_oStage),y=new CInterface,this._initLevel(),this._attachNextBlock();var a=(new createjs.Graphics).beginFill("#fff").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);(H=new createjs.Shape(a)).alpha=0,s_oStage.addChild(H),b=new CGameOver(0,0),x=new CWinPanel(0,0),!1===s_bMobile&&(document.onkeydown=F),setVolume("soundtrack",SOUNDTRACK_VOLUME_IN_GAME),s_oRollingTextManager=new CRollingTextManager,new CHelpPanel(s_oStage)},this.unload=function(){y.unload(),s_oStage.removeEventListener("mousedown",this._onMouseDown),!1===s_bMobile&&(document.onkeydown=null),s_oStage.removeAllChildren()},this.startGame=function(){startPlay(),v.alpha=1,a=STATE_BLOCK_ROTATE,R=!0},this._initLevel=function(){o=0,d=0,c=FIRST_BLOCK_LANDING_Y,l=1,s=FALL_SPEED,N.removeAllChildren(),g=new Array,(f=new Array).push(new createjs.Rectangle(0,FIRST_BLOCK_LANDING_Y,CANVAS_WIDTH,100));var e=s_oSpriteLibrary.getSprite("game_bg");B=createBitmap(e),N.addChild(B);var a=s_oSpriteLibrary.getSprite("perfect_landing"),r=createBitmap(a);r.x=CANVAS_WIDTH/2,r.y=CANVAS_HEIGHT-15,r.regX=a.width/2,N.addChild(r),(v=new createjs.Container).alpha=0,s_oStage.addChild(v);var _=createBitmap(s_oSpriteLibrary.getSprite("trajectory"));_.x=r.x-a.width/2,_.y=0,v.addChild(_),(_=createBitmap(s_oSpriteLibrary.getSprite("trajectory"))).x=r.x+a.width/2,_.y=0,v.addChild(_),y.reset(s_aBlocksPerLevel[i-1],n),O.addEventListener(ON_MOUSE_DOWN,this._onMouseDown,this),t=!1},this._resetLevel=function(){for(var e=0;e<g.length;e++)g[e].unload();I.removeAllChildren(),++i>NUM_LEVELS?this._win():(S=s_aHookSpeed[i-1],parseFloat(S.toFixed(2)),this._initLevel(),L.y=EDGEBOARD_Y+60,w.reset(),this._attachNextBlock(),a=STATE_BLOCK_ROTATE)},this.stopUpdate=function(){t=!0},this.startUpdate=function(){t=!1},this._attachNextBlock=function(){if(++o>1&&(v.alpha=0),y.refreshNumBlocks(g.length),o>s_aBlocksPerLevel[i-1])return n>0&&this._levelComplete(),!1;h=0,u=0;var e=w.getAttachBlockPoint(),t=s_aBlockSequence[i-1][o-1],a=createSprite(s_aBlockSpriteSheet[i-1],"block_"+t,s_aBlockSize[i-1][t].width/2,0,s_aBlockSize[i-1][t].width,s_aBlockSize[i-1][t].height);return C=new CBlock(e.x,e.y,a,s_aBlockSize[i-1][t].width,s_aBlockSize[i-1][t].height,m),g.push(C),!0},this.tweenTrajectory=function(e,t){--t>0?createjs.Tween.get(v).to({alpha:e},200,createjs.Ease.cubicOut).call(function(){s_oGame.tweenTrajectory(0===e?1:0,t)}):v.alpha=0},this._scrollDownCamera=function(){t=!0;for(var e=CANVAS_HEIGHT/2-310-C.getHeight(),i=0;i<g.length;i++)g[i].scrollDownCamera(e);c=C.getY()+e;var n=(new createjs.Graphics).beginFill("#F7F0DE").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT/2),a=new createjs.Shape(n);a.y=-CANVAS_HEIGHT/2*l+l,N.addChild(a);for(var s=Math.floor(3*Math.random()+3),o=0;o<s;o++){var r=Math.floor(3*Math.random()+1),_=Math.floor(Math.random()*(CANVAS_WIDTH-100)),h=Math.floor(500*Math.random()+200),u=createBitmap(s_oSpriteLibrary.getSprite("cloud_"+r));u.x=_,u.y=a.y+h,N.addChild(u)}var d=this;createjs.Tween.get(I).to({y:I.y+e},TIME_GROUND_MOVE,createjs.Ease.cubicOut),createjs.Tween.get(N).to({y:N.y+e},TIME_GROUND_MOVE,createjs.Ease.cubicOut).call(function(){d._endScroll()}),l++},this._endScroll=function(){t=!1,R=!0,(f=new Array).push(new createjs.Rectangle(0,FIRST_BLOCK_LANDING_Y,CANVAS_WIDTH,100));for(var e=0;e<g.length-1;e++)f.push(new createjs.Rectangle(g[e].getX()-g[e].getHalfWidth(),g[e].getY(),g[e].getWidth(),g[e].getHeight()))},this.tremble=function(){var e=s_aTrembleSequence[E];N.x=N.x+e.x,N.y=N.y+e.y,++E===s_aTrembleSequence.length&&(E=0,clearInterval(p))},this._checkForBonus=function(){return!(g.length<2)&&(C.getX()>g[g.length-2].getX()-BONUS_TOLLERANCE&&C.getX()<g[g.length-2].getX()+BONUS_TOLLERANCE&&(this.attachBonus(),!0))},this.attachBonus=function(){var e={framerate:5,images:[s_oSpriteLibrary.getSprite("bonus")],frames:{width:77,height:74,regY:37},animations:{idle:[0,1,"idle"]}},t=new createjs.SpriteSheet(e),n=createSprite(t,"idle",0,37,77,74);n.alpha=0,n.x=C.getX()+s_aBlockSize[i-1][s_aBlockSequence[i-1][o-1]].width/2,n.y=C.getY()-I.y+s_aBlockSize[i-1][s_aBlockSequence[i-1][o-1]].height/2+30,I.addChild(n),createjs.Tween.get(n).to({alpha:1},1e3,createjs.Ease.cubicOut),playSound("bonus",1,!1)},this.checkIfOtherBlocksFalling=function(){if(++u<h){var e=g.pop();e.setY(f[f.length-1].y),this._blockMisplaced(e)}else u===h&&this._attachNextBlock()&&(a=STATE_BLOCK_ROTATE)},this.setBlock=function(e){t=e},this.blockFall=function(){u===h&&this._attachNextBlock()&&(a=STATE_BLOCK_ROTATE)},this._blockMisplaced=function(e){var t;playSound("fall_fail",1,!1),t=e.getX()>f[f.length-1].x+f[f.length-1].width/2?-Math.abs(e.getX()-(f[f.length-1].x+f[f.length-1].width)):Math.abs(f[f.length-1].x-e.getX()),e.misplaced(t),this.loseLife()},this.loseLife=function(){var e=(new createjs.Graphics).beginFill("#f00").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT),t=new createjs.Shape(e);t.alpha=0,s_oStage.addChild(t),createjs.Tween.get(t).to({alpha:.5},200,createjs.Ease.cubicOut).call(function(){createjs.Tween.get(t).to({alpha:0},200,createjs.Ease.cubicOut).call(function(){s_oStage.removeChild(t)})}),0===--n&&this._gameOver(),y.refreshLives(n)},this.showAllTower=function(){a=STATE_SHOW_THE_TOWER,R=!0},this._levelComplete=function(){t=!0,O.removeEventListener(ON_MOUSE_DOWN),y.refreshNumBlocks(g.length),y.levelComplete(i),playSound("end_level",1,!1)},this._gameOver=function(){t=!0,R=!1,a=STATE_BLOCK_ROTATE,_>T&&(T=_),b.show(_)},this._win=function(){t=!0,_>T&&(T=_),x.show(_)},this._onMouseDown=function(e){t||(a=STATE_BLOCK_FALLING)},this.onExit=function(){this.unload(),s_oGame=null,s_oMain.gotoMenu()},this.update=function(){if(!1!==R){if((d+=s_iTimeElaps)>BIRD_OCCURRENCE){d=0;var e=new Array(-1,1),n=e[Math.floor(Math.random()*e.length)],l=Math.floor(Math.random()*(600-N.y-(200-N.y))+(200-N.y));new CBird(n>0?-100:CANVAS_WIDTH+100,l,n,N)}switch(a){case STATE_BLOCK_ROTATE:w.updateRotation(S),C.updateRotation(w.getAttachBlockPoint());break;case STATE_BLOCK_FALLING:C.updateFalling(s);var T=C.getRectangle();if(!0===checkRectIntersection(T,f[f.length-1]))if(C.getX()>f[f.length-1].x&&C.getX()<f[f.length-1].x+f[f.length-1].width){var O=(A=m.getBounds()).x+Math.round(A.width/2);T=C.getRectangle();if(g.length>1&&!1===pointInRect(O,C.getY(),T.x,T.y,T.x+T.width,T.y+T.height)){h=2;var b=g.pop();return this._blockMisplaced(C),f.splice(f.length-1,1),c+=b.getHeight(),void(a=STATE_BLOCK_MISPLACED)}C.setY(c-C.getHeight());var x,v=(Math.abs(CANVAS_WIDTH/2-C.getX())/(CANVAS_WIDTH/2)).toFixed(2);if(r=(BEST_MULTIPLIER*(v=1-v)).toFixed(2),y.showMultiplier(r),x=Math.round(MAX_SCORE_PER_BLOCK-Math.abs(CANVAS_WIDTH/2-C.getX())*r),this._checkForBonus()&&(x*=MULTIPLIER_BONUS_POINT),y.refreshScore(Math.round(x)),_+=Math.round(x),C.attachScore(x,i),c<Y_OFFSET_CAMERA&&o<s_aBlocksPerLevel[i-1])this._scrollDownCamera();else{void 0!==s_aBlockSequence[i-1][o]&&(c=C.getY()),E=0;var B=this;p=setInterval(function(){B.tremble()},20)}if(o===s_aBlocksPerLevel[i-1])return this._levelComplete(),void(a=STATE_HOOK_ROTATE);f.push(new createjs.Rectangle(C.getX()-C.getHalfWidth(),C.getY(),C.getWidth(),C.getHeight())),this._attachNextBlock(),playSound("fall_ok",1,!1),a=STATE_BLOCK_ROTATE}else t=!0,h=1,g.pop(),C.setY(f[f.length-1].y),this._blockMisplaced(C),a=STATE_BLOCK_MISPLACED;else C.getYBase()>CANVAS_HEIGHT&&(this.loseLife(),h=1,u=1,g.pop(),C.unload(),this.blockFall(),a=STATE_BLOCK_ROTATE);break;case STATE_BLOCK_MISPLACED:break;case STATE_SHOW_THE_TOWER:if(N.y>CANVAS_HEIGHT-BG_HEIGHT){N.y-=SPEED_TOWER_SHOWING,I.y-=SPEED_TOWER_SHOWING;for(var F=0;F<g.length;F++)g[F].decreaseY(SPEED_TOWER_SHOWING);L.y-=SPEED_TOWER_SHOWING,w.decreseY(SPEED_TOWER_SHOWING)}else{a=-1;B=this;createjs.Tween.get(H).to({alpha:1},1e3,createjs.Ease.cubicOut).call(function(){B._resetLevel(),createjs.Tween.get(H).to({alpha:0},1e3,createjs.Ease.cubicOut)})}}s_oRollingTextManager.update()}},s_oGame=this,START_HOOK_ROT_SPEED=e.start_hook_rot_speed,HOOK_ROT_INCREASE_FACTOR=e.hook_rot_increase,HOOK_MAX_ROT=e.hook_max_rot,NUM_LIVES=e.num_lives,BEST_MULTIPLIER=e.best_mult,MULTIPLIER_BONUS_POINT=e.bonus_mult,FALL_SPEED=e.block_fall_speed,NUM_LEVELS=e.levels.length,this._init(e.levels)}CTLText.prototype={constructor:CTLText,__autofit:function(){if(this._bFitText){for(var e=this._iFontSize;(this._oText.getBounds().height>this._iHeight-2*this._iPaddingV||this._oText.getBounds().width>this._iWidth-2*this._iPaddingH)&&(e--,this._oText.font=e+"px "+this._szFont,this._oText.lineHeight=Math.round(e*this._fLineHeightFactor),this.__updateY(),this.__verticalAlign(),!(e<8)););this._iFontSize=e}},__verticalAlign:function(){if(this._bVerticalAlign){var e=this._oText.getBounds().height;this._oText.y-=(e-this._iHeight)/2+this._iPaddingV}},__updateY:function(){switch(this._oText.y=this._y+this._iPaddingV,this._oText.textBaseline){case"middle":this._oText.y+=this._oText.lineHeight/2+(this._iFontSize*this._fLineHeightFactor-this._iFontSize)}},__createText:function(e){switch(this._bDebug&&(this._oDebugShape=new createjs.Shape,this._oDebugShape.graphics.beginFill("rgba(255,0,0,0.5)").drawRect(this._x,this._y,this._iWidth,this._iHeight),this._oContainer.addChild(this._oDebugShape)),this._oText=new createjs.Text(e,this._iFontSize+"px "+this._szFont,this._szColor),this._oText.textBaseline="middle",this._oText.lineHeight=Math.round(this._iFontSize*this._fLineHeightFactor),this._oText.textAlign=this._szAlign,this._bMultiline?this._oText.lineWidth=this._iWidth-2*this._iPaddingH:this._oText.lineWidth=null,this._szAlign){case"center":this._oText.x=this._x+this._iWidth/2;break;case"left":this._oText.x=this._x+this._iPaddingH;break;case"right":this._oText.x=this._x+this._iWidth-this._iPaddingH}this._oContainer.addChild(this._oText),this.refreshText(e)},setVerticalAlign:function(e){this._bVerticalAlign=e},setOutline:function(e){null!==this._oText&&(this._oText.outline=e)},setShadow:function(e,t,i,n){null!==this._oText&&(this._oText.shadow=new createjs.Shadow(e,t,i,n))},setColor:function(e){this._oText.color=e},setAlpha:function(e){this._oText.alpha=e},setY:function(e){this._oText.y=e,this._y=e},removeTweens:function(){createjs.Tween.removeTweens(this._oText)},getText:function(){return this._oText},getY:function(){return this._y},getFontSize:function(){return this._iFontSize},refreshText:function(e){""===e&&(e=" "),null===this._oText&&this.__createText(e),this._oText.text=e,this._oText.font=this._iFontSize+"px "+this._szFont,this._oText.lineHeight=Math.round(this._iFontSize*this._fLineHeightFactor),this.__autofit(),this.__updateY(),this.__verticalAlign()}};var s_aBlockSpriteSheet,s_aBlocksPerLevel,s_aBlockSize,s_aBlockSpeed,s_aHookSpeed,s_aTrembleSequence,s_oGame=null;function CGameOver(e,t){var i,n,a,s;this._init=function(e,t){(a=new createjs.Container).alpha=0,a.x=e,a.y=t,s_oStage.addChild(a);var s,o,r,_,l=s_oSpriteLibrary.getSprite("msg_box"),c=createBitmap(l);a.addChild(c),new CTLText(a,(r=CANVAS_WIDTH/2)-(s=500)/2,(_=820)-(o=90)/2,s,o,80,"center","#B11821",FONT_GAME,1,2,2,TEXT_GAMEOVER,!0,!0,!0,!1).setOutline(4),new CTLText(a,r-s/2,_-o/2,s,o,80,"center","#FFFFFF",FONT_GAME,1,2,2,TEXT_GAMEOVER,!0,!0,!0,!1),(n=new CTLText(a,(r=CANVAS_WIDTH/2)-(s=500)/2,(_=1020)-(o=250)/2,s,o,100,"center","#B11821",FONT_GAME,1,2,2,TEXT_SCORE+":\n0",!0,!0,!0,!1)).setOutline(4),i=new CTLText(a,r-s/2,_-o/2,s,o,100,"center","#FFFFFF",FONT_GAME,1,2,2,TEXT_SCORE+":\n0",!0,!0,!0,!1),new CGfxButton(CANVAS_WIDTH/2,1340,s_oSpriteLibrary.getSprite("but_play"),a).addEventListener(ON_MOUSE_UP,this._onButBackHomeRelease,this)},this.show=function(e){s=e,i.refreshText(TEXT_SCORE+":\n"+e),n.refreshText(TEXT_SCORE+":\n"+e),createjs.Tween.get(a).to({alpha:1},500),setVolume("soundtrack",1)},this._onButBackHomeRelease=function(){new CInputPanel(0,0).show(s)},this.onButPlayAgainRelease=function(){a.alpha=0,s_oGame.unload(),s_oMain.gotoGame()},this.isVisible=function(){return 0!==a.alpha},this._init(e,t)}function CGameSettings(e){this._init=function(e){this._initBlockSpriteSheet(e.length),this._initLevelInfo(e),s_aTrembleSequence=new Array({x:10,y:0},{x:-20,y:0},{x:10,y:-10},{x:0,y:20},{x:10,y:-10},{x:-10,y:0})},this._initBlockSpriteSheet=function(e){s_aBlockSize=new Array;for(var t=0;t<e;t++){s_aBlockSize[t]=new Array;for(var i=0;i<8;i++)s_aBlockSize[t][i]={width:264,height:120}}s_aBlockSpriteSheet=new Array;for(var n=1,a=0;a<e;a++){4===n&&(n=1);var s={images:[s_oSpriteLibrary.getSprite("block"+n)],frames:{width:264,height:120,regX:132,regY:0},animations:{block_0:[0],block_1:[1],block_2:[2],block_3:[3],block_4:[4],block_5:[5],block_6:[6],block_7:[7]}};s_aBlockSpriteSheet[a]=new createjs.SpriteSheet(s),n++}},this._initLevelInfo=function(e){(s_aHookSpeed=new Array)[0]=START_HOOK_ROT_SPEED;for(var t=1;t<NUM_LEVELS;t++)s_aHookSpeed[t]=parseFloat((s_aHookSpeed[t-1]+HOOK_ROT_INCREASE_FACTOR).toFixed(2));s_aBlockSequence=new Array;for(t=0;t<e.length;t++){s_aBlockSequence[t]=new Array;for(var i=0;i<e[t];i++)0===i?s_aBlockSequence[t][i]=0:i===e[t]-1?s_aBlockSequence[t][i]=7:s_aBlockSequence[t][i]=Math.floor(5*Math.random()+1)}s_aBlocksPerLevel=new Array;for(var n=0;n<e.length;n++)s_aBlocksPerLevel[n]=s_aBlockSequence[n].length},this._init(e)}function CGfxButton(e,t,i,n){var a,s,o,r,_,l,c,h,u,d=[];return this._init=function(e,t,i,n){a=!1,r=new Array,_=new Array,s=i.width,o=i.height,(h=createBitmap(i)).x=e,h.y=t,h.regX=i.width/2,h.regY=i.height/2,h.cursor="pointer",n.addChild(h),u=n,this._initListener()},this.unload=function(){h.off("mousedown",l),h.off("pressup",c),u.removeChild(h)},this.setVisible=function(e){h.visible=e},this._initListener=function(){l=h.on("mousedown",this.buttonDown),c=h.on("pressup",this.buttonRelease)},this.addEventListener=function(e,t,i){r[e]=t,_[e]=i},this.addEventListenerWithParams=function(e,t,i,n){r[e]=t,_[e]=i,d=n},this.removeEventListener=function(e){r[e]=null,_[e]=null},this.buttonRelease=function(){a||(playSound("click",1,!1),h.scaleX=1,h.scaleY=1,r[ON_MOUSE_UP]&&r[ON_MOUSE_UP].call(_[ON_MOUSE_UP],d))},this.buttonDown=function(){a||(h.scaleX=.9,h.scaleY=.9,r[ON_MOUSE_DOWN]&&r[ON_MOUSE_DOWN].call(_[ON_MOUSE_DOWN],d))},this.setPosition=function(e,t){h.x=e,h.y=t},this.setX=function(e){h.x=e},this.setY=function(e){h.y=e},this.enable=function(){a=!1,h.filters=[],h.cache(0,0,s,o)},this.disable=function(){a=!0;var e=(new createjs.ColorMatrix).adjustSaturation(-100).adjustBrightness(40);h.filters=[new createjs.ColorMatrixFilter(e)],h.cache(0,0,s,o)},this.getButtonImage=function(){return h},this.getX=function(){return h.x},this.getY=function(){return h.y},this._init(e,t,i,n),this}function CHelpPanel(e){var t,i,n,a;this._init=function(){n=new createjs.Container,a.addChild(n);var e=(new createjs.Graphics).beginFill("#000").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT),i=new createjs.Shape(e);i.alpha=.8,n.addChild(i);var s,o,r,_,l=s_oSpriteLibrary.getSprite("help1"),c=createBitmap(l);c.regX=l.width/2,c.x=CANVAS_WIDTH/2,c.y=520,n.addChild(c),l=s_oSpriteLibrary.getSprite("help2"),(c=createBitmap(l)).regX=l.width/2,c.x=CANVAS_WIDTH/2+50,c.y=1400,n.addChild(c),(t=new CTLText(n,(r=CANVAS_WIDTH/2)-(s=CANVAS_WIDTH-400)/2,(_=420)-(o=200)/2,s,o,60,"center","#000000",FONT_GAME,.8,2,2,TEXT_HELP1,!0,!0,!0,!1)).setOutline(4),new CTLText(n,r-s/2,_-o/2,s,o,60,"center","#FFFFFF",FONT_GAME,.8,2,2,TEXT_HELP1,!0,!0,!0,!1),new CTLText(n,(r=CANVAS_WIDTH/2)-(s=CANVAS_WIDTH-400)/2,(_=1320)-(o=200)/2,s,o,60,"center","#000000",FONT_GAME,.8,2,2,TEXT_HELP2,!0,!0,!0,!1),t.setOutline(4),new CTLText(n,r-s/2,_-o/2,s,o,60,"center","#FFFFFF",FONT_GAME,.8,2,2,TEXT_HELP2,!0,!0,!0,!1);var h=this;n.on("pressup",function(){h._onExitHelp()})},this.unload=function(){a.removeChild(n);var e=this;n.off("pressup",function(){e._onExitHelp()})},this._onExitHelp=function(){i.unload(),s_oGame.startGame()},a=e,i=this,this._init()}function CHook(){var e,t,i,n,a,s,o,r,_=0,l={x:0,y:1};this._init=function(){e=0,2,(a=new createjs.Graphics).setStrokeStyle(HOOK_THICKNESS),a.beginStroke("#000"),a.moveTo(HOOK_START_X-10,HOOK_START_Y),a.lineTo(HOOK_START_X-10,HOOK_START_Y+LINE_LENGTH),n=new createjs.Shape(a),s_oStage.addChild(n),(o=new createjs.Graphics).setStrokeStyle(HOOK_THICKNESS),o.beginStroke("#000"),o.moveTo(HOOK_START_X+10,HOOK_START_Y),o.lineTo(HOOK_START_X+10,HOOK_START_Y+LINE_LENGTH),s=new createjs.Shape(o),s_oStage.addChild(s);var t=s_oSpriteLibrary.getSprite("hook");(r=createBitmap(t)).regX=t.width/2,s_oStage.addChild(r),this._drawLine()},this.reset=function(){_=0,t=HOOK_START_X,i=HOOK_START_Y+LINE_LENGTH,n.y=s.y=0},this.decreseY=function(e){n.y-=e,s.y-=e,r.y-=e},this.normalize=function(e){var t=Math.sqrt(e.x*e.x+e.y*e.y);t>0&&(e.x/=t,e.y/=t)},this.rotateVector2D=function(e,t){var i=t.x*Math.cos(e)+t.y*Math.sin(e),n=t.x*-Math.sin(e)+t.y*Math.cos(e);t.x=i,t.y=n},this.toDegree=function(e){return e*(180/Math.PI)},this._drawLine=function(){var n=Math.sin(e);l.x=0,l.y=1;var s=Math.PI/2*HOOK_MAX_ROT*n;this.rotateVector2D(s,l),this.normalize(l);var c=l.x*(LINE_LENGTH+_),h=l.y*(LINE_LENGTH+_);t=HOOK_START_X+c,i=HOOK_START_Y+h,a.clear(),a.setStrokeStyle(HOOK_THICKNESS),a.beginStroke("#000"),a.moveTo(HOOK_START_X-8,HOOK_START_Y),a.lineTo(t-8,i),o.clear(),o.setStrokeStyle(HOOK_THICKNESS),o.beginStroke("#000"),o.moveTo(HOOK_START_X+8,HOOK_START_Y),o.lineTo(t+8,i),r.x=t,r.y=i-10},this.getAttachBlockPoint=function(){return{x:r.x,y:r.y+30}},this.updateRotation=function(t){e+=t,this._drawLine()},this._init()}function CInputPanel(e,t){var i,n,a,s,o,r,_,l,c,h,u,d,T;this._init=function(e,t){u=document.getElementById("nameInput"),d=document.getElementById("phoneInput"),T=document.getElementById("emailInput"),this.enableKeyboardInput(),(a=new createjs.Container).alpha=0,a.x=e,a.y=t,s_oStage.addChild(a);var s=s_oSpriteLibrary.getSprite("msg_box2"),S=createBitmap(s);a.addChild(S),(n=new CTLText(a,(g=CANVAS_WIDTH/2)-(E=500)/2,(f=820)-(p=90)/2,E,p,80,"center","#B11821",FONT_GAME,1,2,2,TEXT_GAMEOVER,!0,!0,!0,!1)).setOutline(4),i=new CTLText(a,g-E/2,f-p/2,E,p,80,"center","#FFFFFF",FONT_GAME,1,2,2,TEXT_GAMEOVER,!0,!0,!0,!1);var E=500,p=250,g=CANVAS_WIDTH/2,f=1020;(r=new CTLText(a,CANVAS_WIDTH/2-8*s.width/10,45.5*CANVAS_HEIGHT/100,E,p,40,"center","#B11821",FONT_GAME,1.1,36,0,"",!0,!0,!1,!1)).setOutline(5),o=new CTLText(a,CANVAS_WIDTH/2-8*s.width/10,45.5*CANVAS_HEIGHT/100,s.width,70,40,"center","#FFFFFF",FONT_GAME,1.1,50,0,"",!0,!0,!1,!1),(l=new CTLText(a,CANVAS_WIDTH/2-8*s.width/10,50.5*CANVAS_HEIGHT/100,s.width,70,40,"center","#B11821",FONT_GAME,1.1,0,0,"",!0,!0,!1,!1)).setOutline(5),_=new CTLText(a,CANVAS_WIDTH/2-8*s.width/10,50.5*CANVAS_HEIGHT/100,s.width,70,40,"center","#FFFFFF",FONT_GAME,1.1,0,0,"",!0,!0,!1,!1),(h=new CTLText(a,CANVAS_WIDTH/2-8*s.width/10,56*CANVAS_HEIGHT/100,s.width,70,40,"center","#B11821",FONT_GAME,1.1,0,0,"",!0,!0,!1,!1)).setOutline(5),c=new CTLText(a,CANVAS_WIDTH/2-8*s.width/10,56*CANVAS_HEIGHT/100,s.width,70,40,"center","#FFFFFF",FONT_GAME,1.1,0,0,"",!0,!0,!1,!1),new CGfxButton(860,1340,s_oSpriteLibrary.getSprite("but_play_again"),a).addEventListener(ON_MOUSE_UP,this.onButPlayAgainRelease,this),new CGfxButton(540,1340,s_oSpriteLibrary.getSprite("but_back_home"),a).addEventListener(ON_MOUSE_UP,this._onButBackHomeRelease,this)},this.show=function(e){s=e,this.inputVisibility(!0),i.refreshText("Data"),n.refreshText("Data"),createjs.Tween.get(a).to({alpha:1},500),r.refreshText("Name"),o.refreshText("Name"),l.refreshText("Phone"),_.refreshText("Phone"),h.refreshText("Email"),c.refreshText("Email"),setVolume("soundtrack",1)},this.inputVisibility=function(e){1==e?($("#nameInput").fadeIn(1e3),$("#phoneInput").fadeIn(1e3),$("#emailInput").fadeIn(1e3)):($("#nameInput").fadeOut(10),$("#phoneInput").fadeOut(10),$("#emailInput").fadeOut(10))},this.inputGetValue=function(){var e=u.value,t=d.value,i=T.value,n=s;return""!=e&&""!=t&&""!=i&&(u.value="",d.value="",T.value="",doRecordVisit(),saveData(e,n,t,i),this.inputVisibility(!1),!0)},this._onButBackHomeRelease=function(){this.inputGetValue()&&s_oGame.onExit()},this.onButPlayAgainRelease=function(){this.inputGetValue()&&(a.alpha=0,s_oGame.unload(),s_oMain.gotoGame())},this.isVisible=function(){return 0!==a.alpha},this.enableKeyboardInput=function(){$("#nameInput").off("keydown"),$("#phoneInput").off("keydown"),$("#emailInput").off("keydown"),$("#nameInput").on("keydown",e=>{"Backspace"===e.key?u.value=u.value.slice(0,u.value.length-1):1==e.key.length&&(u.value+=e.key)}),$("#phoneInput").on("keydown",e=>{"Backspace"===e.key?d.value=d.value.slice(0,d.value.length-1):1==e.key.length&&(d.value+=e.key)}),$("#emailInput").on("keydown",e=>{"Backspace"===e.key?T.value=T.value.slice(0,T.value.length-1):1==e.key.length&&(T.value+=e.key)})},this._init(e,t)}function CInterface(){var e,t,i,n,a,s,o,r,_,l,c,h,u,d,T,S,E=null,p=null;return this._init=function(){i={x:10,y:10},(d=new createjs.Container).x=i.x,d.y=i.y,s_oStage.addChild(d);var g=createBitmap(s_oSpriteLibrary.getSprite("information_panel"));d.addChild(g),(_=new createjs.Text("0","50px "+FONT_GAME,"#000000")).x=80,_.y=50,_.outline=4,_.textAlign="left",_.textBaseline="alphabetic",d.addChild(_),(l=new createjs.Text("0","50px "+FONT_GAME,"#FFFFFF")).x=80,l.y=50,l.textAlign="left",l.textBaseline="alphabetic",d.addChild(l),(o=new createjs.Text("","50px "+FONT_GAME,"#000000")).x=80,o.y=110,o.outline=4,o.textAlign="left",o.textBaseline="alphabetic",d.addChild(o),(r=new createjs.Text("","50px "+FONT_GAME,"#FFFFFF")).x=80,r.y=110,r.textAlign="left",r.textBaseline="alphabetic",d.addChild(r);var f=s_oSpriteLibrary.getSprite("floor_icon");n={x:CANVAS_WIDTH-f.width-20,y:CANVAS_HEIGHT-EDGEBOARD_Y},(T=new createjs.Container).x=n.x,T.y=n.y,s_oStage.addChild(T);var A=createBitmap(f);T.addChild(A),(c=new createjs.Text(0,"60px "+FONT_GAME,"#000000")).x=f.width/2+3,c.y=30,c.outline=4,c.textAlign="center",c.textBaseline="middle",T.addChild(c),(s=new createjs.Text(0,"60px "+FONT_GAME,"#FFFFFF")).x=f.width/2+3,s.y=30,s.textAlign="center",s.textBaseline="middle",T.addChild(s);var C=s_oSpriteLibrary.getSprite("exit_button");if(t={x:CANVAS_WIDTH-C.height/2-10,y:C.height/2+10},(h=new CGfxButton(t.x,t.y,C,s_oStage)).addEventListener(ON_MOUSE_UP,this._onButExitRelease,this),!1===DISABLE_SOUND_MOBILE||!1===s_bMobile){C=s_oSpriteLibrary.getSprite("audio_icon");e={x:t.x-C.width/2-10,y:C.height/2+10},(u=new CToggle(e.x,e.y,C,s_bAudioActive,s_oStage)).addEventListener(ON_MOUSE_UP,this._onAudioToggle,this),C=s_oSpriteLibrary.getSprite("but_fullscreen"),a={x:e.x-C.width/2-10,y:e.y}}else C=s_oSpriteLibrary.getSprite("but_fullscreen"),a={x:t.x-C.width/2-10,y:C.height/2+10};var O=window.document,L=O.documentElement;E=L.requestFullscreen||L.mozRequestFullScreen||L.webkitRequestFullScreen||L.msRequestFullscreen,p=O.exitFullscreen||O.mozCancelFullScreen||O.webkitExitFullscreen||O.msExitFullscreen,!1===ENABLE_FULLSCREEN&&(E=!1),E&&screenfull.isEnabled&&(S=new CToggle(a.x,a.y,C,s_bFullscreen,s_oStage)).addEventListener(ON_MOUSE_UP,this._onFullscreenRelease,this),this.refreshButtonPos(s_iOffsetX,s_iOffsetY)},this.unload=function(){h.unload(),!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||(u.unload(),u=null),E&&screenfull.isEnabled&&S.unload(),s_oInterface=null},this.reset=function(e,t){s.text=e,c.text=e,r.text="x"+t,o.text="x"+t},this.refreshButtonPos=function(s,o){h.setPosition(t.x-s,o+t.y),!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||u.setPosition(e.x-s,o+e.y),E&&screenfull.isEnabled&&S.setPosition(a.x-s_iOffsetX,a.y+s_iOffsetY),d.x=i.x+s,d.y=i.y+o,T.x=n.x-s,T.y=n.y-o},this.refreshNumBlocks=function(e){s.text=e,c.text=e},this.refreshScore=function(e){s_oRollingTextManager.add(l,_,e,1e3,EASE_LINEAR,null)},this.refreshBestScore=function(e){(void 0).text=e},this.refreshLives=function(e){r.text="x"+e,o.text="x"+e},this.showMultiplier=function(e){var t;e>1.9?t=TEXT_PERFECT:e>1.8&&e<=1.9?t=TEXT_GREAT:e>1.5&&e<=1.8?t=TEXT_GOOD:(t=TEXT_BAD,s_oGame.tweenTrajectory(1,10));var i=new createjs.Text(t+"\nX "+e,"80px "+FONT_GAME,"#000000");i.lineHeight=90,i.x=CANVAS_WIDTH/2,i.y=-100,i.textAlign="center",i.textBaseline="alphabetic",i.outline=8,s_oStage.addChild(i);var n=new createjs.Text(t+"\nX "+e,"80px "+FONT_GAME,"#FFFFFF");n.lineHeight=90,n.x=CANVAS_WIDTH/2,n.y=-100,n.textAlign="center",n.textBaseline="alphabetic",s_oStage.addChild(n),createjs.Tween.get(n).to({y:250},500,createjs.Ease.elasticOut).call(function(){createjs.Tween.get(n).wait(600).to({y:-100},200,createjs.Ease.cubicOut).call(function(){s_oStage.removeChild(n)})}),createjs.Tween.get(i).to({y:250},500,createjs.Ease.elasticOut).call(function(){createjs.Tween.get(i).wait(600).to({y:-100},200,createjs.Ease.cubicOut).call(function(){s_oStage.removeChild(i)})})},this.levelComplete=function(e){var t=new createjs.Text(TEXT_CONGRATS+"\n"+TEXT_LEVEL+" "+e+" "+TEXT_COMPLETED+"!","100px "+FONT_GAME,"#000000");t.textAlign="center",t.lineWidth=550,t.outline=8,t.scaleX=t.scaleY=3,t.x=CANVAS_WIDTH/2,t.y=CANVAS_HEIGHT/2,s_oStage.addChild(t);var i=new createjs.Text(TEXT_CONGRATS+"\n"+TEXT_LEVEL+" "+e+" "+TEXT_COMPLETED+"!","100px "+FONT_GAME,"#FFFFFF");i.textAlign="center",i.lineWidth=550,i.scaleX=i.scaleY=3,i.x=CANVAS_WIDTH/2,i.y=CANVAS_HEIGHT/2,s_oStage.addChild(i);var n=this;createjs.Tween.get(i).to({scaleX:1,scaleY:1},1500,createjs.Ease.elasticOut).call(function(){n.fadeOutLevelCompleteText(i,t)}),createjs.Tween.get(t).to({scaleX:1,scaleY:1},1500,createjs.Ease.elasticOut)},this.showLevelCompleteText=function(e){var t=new createjs.Text("COMPLIMENTI, HAI SUPERATO IL "+e+"° LIVELLO!","70px "+FONT_GAME,"#000000");t.textAlign="center",t.lineWidth=550,t.outline=5,t.x=CANVAS_WIDTH/2,t.y=-50,s_oStage.addChild(t);var i=new createjs.Text("COMPLIMENTI, HAI SUPERATO IL "+e+"° LIVELLO!","70px "+FONT_GAME,"#FFFFFF");i.textAlign="center",i.lineWidth=550,i.x=CANVAS_WIDTH/2,i.y=-50,s_oStage.addChild(i);var n=this;createjs.Tween.get(i).to({y:CANVAS_HEIGHT/2-150},1500,createjs.Ease.bounceOut).call(function(){n.fadeOutLevelCompleteText(i,t)}),createjs.Tween.get(t).to({y:CANVAS_HEIGHT/2-150},1500,createjs.Ease.bounceOut)},this.fadeOutLevelCompleteText=function(e,t){createjs.Tween.get(e).to({alpha:0},1e3,createjs.Ease.quadIn).call(function(){s_oStage.removeChild(e),s_oGame.showAllTower()}),createjs.Tween.get(t).to({alpha:0},1e3,createjs.Ease.quadIn).call(function(){s_oStage.removeChild(t)})},this._onButExitRelease=function(){s_oGame.onExit()},this._onAudioToggle=function(){Howler.mute(s_bAudioActive),s_bAudioActive=!s_bAudioActive},this.resetFullscreenBut=function(){E&&screenfull.isEnabled&&S.setActive(s_bFullscreen)},this._onFullscreenRelease=function(){s_bFullscreen?p.call(window.document):E.call(window.document.documentElement),sizeHandler()},s_oInterface=this,this._init(),this}var s_bMobile,s_oInterface=null,TEXT_GAMEOVER="GAME OVER",TEXT_CONGRATS="CONGRATULATIONS!!",TEXT_WIN="YOU WIN!!!",TEXT_PLAY="PLAY",TEXT_EXIT="EXIT",TEXT_SCORE="SCORE",TEXT_BEST_SCORE="BEST",TEXT_LEVEL="LEVEL",TEXT_LIVES="LIVES",TEXT_COMPLETED="COMPLETED",TEXT_PERFECT="PERFECT!!",TEXT_GREAT="GREAT!",TEXT_GOOD="GOOD",TEXT_BAD="TOO BAD!!",TEXT_MULTIPLIER="YOUR MULTIPLIER IS",TEXT_HELP1="DROP THE BLOCKS IN THE CENTER OF THE SCREEN TO GET BEST SCORE MULTIPLIER!!",TEXT_HELP2="STACK BLOCKS PERFECTLY TO GET AN EXTRA BONUS!",TEXT_CREDITS_DEVELOPED="DEVELOPED BY",TEXT_PRELOADER_CONTINUE="START",TEXT_SHARE_IMAGE="200x200.jpg",TEXT_SHARE_TITLE="Congratulations!",TEXT_SHARE_MSG1="You collected <strong>",TEXT_SHARE_MSG2=" points</strong>!<br><br>Share your score with your friends!",TEXT_SHARE_SHARE1="My score is ",TEXT_SHARE_SHARE2=" points! Can you do better?";function CCreditsPanel(){var e,t,i,n,a,s;this._init=function(){s=new createjs.Container,s_oStage.addChild(s);var o=s_oSpriteLibrary.getSprite("msg_box");(n=new createjs.Shape).graphics.beginFill("#000").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT),n.alpha=.5,n.on("click",this._onLogoButRelease),n.cursor="pointer",s.addChild(n),(e=createBitmap(o)).x=CANVAS_WIDTH/2,e.y=CANVAS_HEIGHT/2,e.regX=.5*o.width,e.regY=.5*o.height,s.addChild(e);var r,_,l=s_oSpriteLibrary.getSprite("exit_button");(i=new CGfxButton((a={x:.5*CANVAS_WIDTH+230,y:780}).x,a.y,l,s)).addEventListener(ON_MOUSE_UP,this.unload,this),new CTLText(s,CANVAS_WIDTH/2-(r=450)/2,.5*CANVAS_HEIGHT-74-(_=60)/2,r,_,50,"center","#ffffff",FONT_GAME,1,2,2,TEXT_CREDITS_DEVELOPED,!0,!0,!0,!1),l=s_oSpriteLibrary.getSprite("logo_ctl"),(t=createBitmap(l)).regX=l.width/2,t.regY=l.height/2,t.x=CANVAS_WIDTH/2,t.y=CANVAS_HEIGHT/2,s.addChild(t),new CTLText(s,CANVAS_WIDTH/2-(r=450)/2,.5*CANVAS_HEIGHT+70-(_=50)/2,r,_,40,"center","#ffffff",FONT_GAME,1,2,2,"WWW.CODETHISLAB.COM",!0,!0,!0,!1)},this.unload=function(){n.off("click",this._onLogoButRelease),i.unload(),i=null,s_oStage.removeChild(s)},this._onLogoButRelease=function(){window.open("http://www.codethislab.com/index.php?&l=en","_blank")},this._init()}function CMain(e){var t,i,n,a=!0,s=0,o=0,r=STATE_LOADING;this.initContainer=function(){var e=document.getElementById("canvas");(s_oStage=new createjs.Stage(e)).preventSelection=!1,createjs.Touch.enable(s_oStage),!1===(s_bMobile=jQuery.browser.mobile)&&s_oStage.enableMouseOver(20),s_iPrevTime=(new Date).getTime(),createjs.Ticker.framerate=FPS,createjs.Ticker.addEventListener("tick",this._update),navigator.userAgent.match(/Windows Phone/i)&&(DISABLE_SOUND_MOBILE=!0),s_oSpriteLibrary=new CSpriteLibrary,i=new CPreloader},this.soundLoaded=function(){s++;var e=Math.floor(s/o*100);i.refreshLoader(e)},this._initSounds=function(){Howler.mute(!s_bAudioActive),(s_aSoundsInfo=new Array).push({path:"./sounds/",filename:"bonus",loop:!1,volume:1,ingamename:"bonus"}),s_aSoundsInfo.push({path:"./sounds/",filename:"click",loop:!1,volume:1,ingamename:"click"}),s_aSoundsInfo.push({path:"./sounds/",filename:"end_level",loop:!1,volume:1,ingamename:"end_level"}),s_aSoundsInfo.push({path:"./sounds/",filename:"fall_fail",loop:!1,volume:1,ingamename:"fall_fail"}),s_aSoundsInfo.push({path:"./sounds/",filename:"fall_ok",loop:!1,volume:1,ingamename:"fall_ok"}),s_aSoundsInfo.push({path:"./sounds/",filename:"soundtrack",loop:!0,volume:1,ingamename:"soundtrack"}),o+=s_aSoundsInfo.length,s_aSounds=new Array;for(var e=0;e<s_aSoundsInfo.length;e++)this.tryToLoadSound(s_aSoundsInfo[e],!1)},this.tryToLoadSound=function(e,t){setTimeout(function(){s_aSounds[e.ingamename]=new Howl({src:[e.path+e.filename+".mp3"],autoplay:!1,preload:!0,loop:e.loop,volume:e.volume,onload:s_oMain.soundLoaded,onloaderror:function(e,t){for(var i=0;i<s_aSoundsInfo.length;i++)if(e===s_aSounds[s_aSoundsInfo[i].ingamename]._sounds[0]._id){s_oMain.tryToLoadSound(s_aSoundsInfo[i],!0);break}},onplayerror:function(e){for(var t=0;t<s_aSoundsInfo.length;t++)if(e===s_aSounds[s_aSoundsInfo[t].ingamename]._sounds[0]._id){s_aSounds[s_aSoundsInfo[t].ingamename].once("unlock",function(){s_aSounds[s_aSoundsInfo[t].ingamename].play(),"soundtrack"===s_aSoundsInfo[t].ingamename&&null!==s_oGame&&setVolume("soundtrack",SOUNDTRACK_VOLUME_IN_GAME)});break}}})},t?200:0)},this._loadImages=function(){s_oSpriteLibrary.init(this._onImagesLoaded,this._onAllImagesLoaded,this),s_oSpriteLibrary.addSprite("bg_menu","./sprites/bg_menu.jpg"),s_oSpriteLibrary.addSprite("audio_icon","./sprites/audio_icon.png"),s_oSpriteLibrary.addSprite("bonus","./sprites/bonus.png"),s_oSpriteLibrary.addSprite("hook","./sprites/hook.png"),s_oSpriteLibrary.addSprite("crane","./sprites/crane.png"),s_oSpriteLibrary.addSprite("block1","./sprites/block1.png"),s_oSpriteLibrary.addSprite("block2","./sprites/block2.png"),s_oSpriteLibrary.addSprite("block3","./sprites/block3.png"),s_oSpriteLibrary.addSprite("but_back_home","./sprites/but_back_home.png"),s_oSpriteLibrary.addSprite("but_play_again","./sprites/but_play_again.png"),s_oSpriteLibrary.addSprite("but_play","./sprites/but_play.png"),s_oSpriteLibrary.addSprite("hit_area","./sprites/hit_area.png"),s_oSpriteLibrary.addSprite("game_bg","./sprites/game_bg.jpg"),s_oSpriteLibrary.addSprite("perfect_landing","./sprites/perfect_landing.png"),s_oSpriteLibrary.addSprite("logo","./sprites/logo.png"),s_oSpriteLibrary.addSprite("exit_button","./sprites/exit_button.png"),s_oSpriteLibrary.addSprite("bird","./sprites/bird.png"),s_oSpriteLibrary.addSprite("cloud_1","./sprites/cloud_1.png"),s_oSpriteLibrary.addSprite("cloud_2","./sprites/cloud_2.png"),s_oSpriteLibrary.addSprite("cloud_3","./sprites/cloud_3.png"),s_oSpriteLibrary.addSprite("cloud_4","./sprites/cloud_4.png"),s_oSpriteLibrary.addSprite("msg_box","./sprites/msg_box.png"),s_oSpriteLibrary.addSprite("information_panel","./sprites/information_panel.png"),s_oSpriteLibrary.addSprite("floor_icon","./sprites/floor_icon.png"),s_oSpriteLibrary.addSprite("help1","./sprites/help1.jpg"),s_oSpriteLibrary.addSprite("help2","./sprites/help2.png"),s_oSpriteLibrary.addSprite("trajectory","./sprites/trajectory.png"),s_oSpriteLibrary.addSprite("logo_ctl","./sprites/logo_ctl.png"),s_oSpriteLibrary.addSprite("but_info","./sprites/but_info.png"),s_oSpriteLibrary.addSprite("but_fullscreen","./sprites/but_fullscreen.png"),s_oSpriteLibrary.addSprite("msg_box2","./sprites/msg_box2.png"),s_oSpriteLibrary.addSprite("logo_glo","./sprites/logo_glo.png"),s_oSpriteLibrary.addSprite("logo_glogames","./sprites/logo_glogames.png"),o+=s_oSpriteLibrary.getNumSprites(),s_oSpriteLibrary.loadSprites()},this._onImagesLoaded=function(){s++;var e=Math.floor(s/o*100);i.refreshLoader(e)},this.preloaderReady=function(){this._loadImages(),!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||this._initSounds()},this._onRemovePreloader=function(){i.unload(),s_oSoundTrack=playSound("soundtrack",1,!0),this.gotoSplash()},this._onAllImagesLoaded=function(){},this.gotoSplash=function(){new CSplashScreen},this.gotoMenu=function(){new CMenu,r=STATE_MENU},this.gotoGame=function(){n=new CGame(t),r=STATE_GAME},this.gotoHelp=function(){new CHelp,r=STATE_HELP},this.stopUpdate=function(){a=!1,createjs.Ticker.paused=!0,$("#block_game").css("display","block"),!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||Howler.mute(!0)},this.startUpdate=function(){s_iPrevTime=(new Date).getTime(),a=!0,createjs.Ticker.paused=!1,$("#block_game").css("display","none"),!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||s_bAudioActive&&Howler.mute(!1)},this._update=function(e){if(!1!==a){var t=(new Date).getTime();s_iTimeElaps=t-s_iPrevTime,s_iCntFps++,s_iPrevTime=t,(s_iCntTime+=s_iTimeElaps)>=1e3&&(s_iCurFps=s_iCntFps,s_iCntTime-=1e3,s_iCntFps=0),r===STATE_GAME&&n.update(),s_oStage.update(e)}},s_oMain=this,t=e,ENABLE_FULLSCREEN=e.fullscreen,ENABLE_CHECK_ORIENTATION=e.check_orientation,s_bAudioActive=e.audio_enable_on_startup,this.initContainer()}var s_oRollingTextManager,s_oDrawLayer,s_oStage,s_oMain,s_oSpriteLibrary,s_aSounds,s_aSoundsInfo,s_bAudioActive=!1,s_iCntTime=0,s_iTimeElaps=0,s_iPrevTime=0,s_iCntFps=0,s_iCurFps=0,s_oSoundTrack=null,s_bFullscreen=!1;function CMenu(){var e,t,i,n,a,s,o,r,_,l=null,c=null;function h(e){switch(e||(e=window.event),e.keyCode){case 32:s_oMenu._onButPlayRelease()}return e.preventDefault(),!1}this._init=function(){n=new createBitmap(s_oSpriteLibrary.getSprite("bg_menu")),s_oStage.addChild(n);var u=s_oSpriteLibrary.getSprite("logo");t={x:CANVAS_WIDTH/2,y:120},(s=new createBitmap(u)).x=t.x,s.y=t.y,s.regX=u.width/2,s_oStage.addChild(s);u=s_oSpriteLibrary.getSprite("but_play");if((a=new CGfxButton(CANVAS_WIDTH/2,CANVAS_HEIGHT/2-90,u,s_oStage)).addEventListener(ON_MOUSE_UP,this._onButPlayRelease,this),!1===DISABLE_SOUND_MOBILE||!1===s_bMobile){u=s_oSpriteLibrary.getSprite("audio_icon");e={x:CANVAS_WIDTH-u.height/2-10,y:u.height/2+10},(r=new CToggle(e.x,e.y,u,s_bAudioActive,s_oStage)).addEventListener(ON_MOUSE_UP,this._onAudioToggle,this),setVolume("soundtrack",1)}var d=window.document,T=d.documentElement;l=T.requestFullscreen||T.mozRequestFullScreen||T.webkitRequestFullScreen||T.msRequestFullscreen,c=d.exitFullscreen||d.mozCancelFullScreen||d.webkitExitFullscreen||d.msExitFullscreen,!1===ENABLE_FULLSCREEN&&(l=!1),l&&screenfull.isEnabled&&(u=s_oSpriteLibrary.getSprite("but_fullscreen"),i={x:u.height/2+10,y:u.height/2+10},(_=new CToggle(i.x,i.y,u,s_bFullscreen,s_oStage)).addEventListener(ON_MOUSE_UP,this._onFullscreenRelease,this)),(o=new createjs.Shape).graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT),s_oStage.addChild(o),createjs.Tween.get(o).to({alpha:0},1e3).call(function(){o.visible=!1}),!1===s_bMobile&&(document.onkeydown=h),this.refreshButtonPos(s_iOffsetX,s_iOffsetY)},this.unload=function(){a.unload(),a=null,!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||(r.unload(),r=null),l&&screenfull.isEnabled&&_.unload(),s_oStage.removeAllChildren(),s_oMenu=null},this.refreshButtonPos=function(n,a){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||r.setPosition(e.x-n,a+e.y),l&&screenfull.isEnabled&&_.setPosition(i.x+s_iOffsetX,i.y+s_iOffsetY),s.y=t.y+a},this._onAudioToggle=function(){Howler.mute(s_bAudioActive),s_bAudioActive=!s_bAudioActive},this.resetFullscreenBut=function(){l&&screenfull.isEnabled&&_.setActive(s_bFullscreen)},this._onFullscreenRelease=function(){s_bFullscreen?c.call(window.document):l.call(window.document.documentElement),sizeHandler()},this._onButPlayRelease=function(){s_oMenu.unload(),s_oMain.gotoGame(),$(s_oMain).trigger("start_session")},s_oMenu=this,this._init()}var s_oTweenController,s_oMenu=null;function CPreloader(){var e,t,i,n,a,s,o,r,_,l;this._init=function(){s_oSpriteLibrary.init(this._onImagesLoaded,this._onAllImagesLoaded,this),s_oSpriteLibrary.addSprite("progress_bar","./sprites/progress_bar.png"),s_oSpriteLibrary.addSprite("200x200","./sprites/200x200.jpg"),s_oSpriteLibrary.addSprite("but_start","./sprites/but_start.png"),s_oSpriteLibrary.loadSprites(),l=new createjs.Container,s_oStage.addChild(l)},this.unload=function(){l.removeAllChildren(),_.unload()},this._onImagesLoaded=function(){},this._onAllImagesLoaded=function(){this.attachSprites(),s_oMain.preloaderReady()},this.attachSprites=function(){var c=new createjs.Shape;c.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT),l.addChild(c);var h=s_oSpriteLibrary.getSprite("200x200");(o=createBitmap(h)).regX=.5*h.width,o.regY=.5*h.height,o.x=CANVAS_WIDTH/2,o.y=CANVAS_HEIGHT/2-180,l.addChild(o),(r=new createjs.Shape).graphics.beginFill("rgba(0,0,0,0.01)").drawRoundRect(o.x-100,o.y-100,200,200,10),l.addChild(r),o.mask=r;h=s_oSpriteLibrary.getSprite("progress_bar");(n=createBitmap(h)).x=CANVAS_WIDTH/2-h.width/2,n.y=CANVAS_HEIGHT/2+50,l.addChild(n),e=h.width,t=h.height,(a=new createjs.Shape).graphics.beginFill("rgba(0,0,0,0.01)").drawRect(n.x,n.y,1,t),l.addChild(a),n.mask=a,(i=new createjs.Text("","30px "+FONT_GAME,"#fff")).x=CANVAS_WIDTH/2,i.y=CANVAS_HEIGHT/2+100,i.textBaseline="alphabetic",i.textAlign="center",l.addChild(i);h=s_oSpriteLibrary.getSprite("but_start");(_=new CTextButton(CANVAS_WIDTH/2,CANVAS_HEIGHT/2,h,TEXT_PRELOADER_CONTINUE,"Arial","#000","bold 50",l)).addEventListener(ON_MOUSE_UP,this._onButStartRelease,this),_.setVisible(!1),(s=new createjs.Shape).graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT),l.addChild(s),createjs.Tween.get(s).to({alpha:0},500).call(function(){createjs.Tween.removeTweens(s),l.removeChild(s)})},this._onButStartRelease=function(){s_oMain._onRemovePreloader()},this.refreshLoader=function(s){i.text=s+"%",100===s&&(s_oMain._onRemovePreloader(),_.setVisible(!1),i.visible=!1,n.visible=!1),a.graphics.clear();var o=Math.floor(s*e/100);a.graphics.beginFill("rgba(0,0,0,0.01)").drawRect(n.x,n.y,o,t)},this._init()}function CRollingTextController(e,t,i,n,a){var s,o,r,_,l,c,h,u,d,T,S;this._init=function(e,t,i,n,a){u=new Array,d=new Array,l=n,this.setUpdateInfo(i),h=a,T=e,S=t},this.setUpdateInfo=function(t){r=parseFloat(e.text),_=r+t,s=0,o=Math.round(l/FPS),c=0},this.addEventListener=function(e,t,i){u[e]=t,d[e]=i},this.increaseValue=function(e){c=e},this.getTarget=function(){return T},this.update=function(){if(++s>o)return s=0,T.text=_.toFixed(0),null!==S&&(S.text=_.toFixed(0)),null!==u[ON_CONTROLLER_END]&&u[ON_CONTROLLER_END].call(d[ON_CONTROLLER_END],this),void(c>0?this.setUpdateInfo(c):u[ON_CONTROLLER_REMOVE].call(d[ON_CONTROLLER_REMOVE],this));var e;switch(h){case EASE_BACKIN:e=s_oTweenController.easeInBack(s,0,1,o);break;case EASE_BACKOUT:e=s_oTweenController.easeOutBack(s,0,1,o);break;case EASE_CUBIC_IN:e=s_oTweenController.easeInCubic(s,0,1,o);break;case EASE_CUBIC_OUT:e=s_oTweenController.easeOutCubic(s,0,1,o);break;case EASE_ELASTIC_OUT:e=s_oTweenController.easeOutElastic(s,0,1,o);break;case EASE_LINEAR:e=s_oTweenController.easeLinear(s,0,1,o);break;case EASE_QUART_BACKIN:e=s_oTweenController.easeBackInQuart(s,0,1,o);break;default:e=s_oTweenController.easeLinear(s,0,1,o)}var t=s_oTweenController.tweenValue(r,_,e);T.text=t.toFixed(0),null!==S&&(S.text=t.toFixed(0))},this._init(e,t,i,n,a)}function CRollingTextManager(){var e=new Array,t=new Array;s_oTweenController=new CTweenController,this.add=function(t,i,n,a,s,o,r){var _=this._checkIfControllerExist(t);if(-1===_){var l=new CRollingTextController(t,i,n,a,s);l.addEventListener(ON_CONTROLLER_END,o,r),l.addEventListener(ON_CONTROLLER_REMOVE,this._onRemoveController,this),e.push(l)}else e[_].increaseValue(n)},this._checkIfControllerExist=function(t){for(var i=0;i<e.length;i++)if(e[i].getTarget()===t)return i;return-1},this._onRemoveController=function(e){t.push(e)},this.update=function(){for(var i=0;i<e.length;i++)e[i].update();for(var n=0;n<t.length;n++)for(var a=0;a<e.length;a++)if(t[n]===e[a]){e.splice(a,1);break}t=new Array}}function CSplashScreen(){var e,t,i,n,a;this._init=function(){i=new createjs.Container;var s=(new createjs.Graphics).beginFill("#ffffff").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT),o=new createjs.Shape(s);i.addChild(o),s_oStage.addChild(i),e=s_oSpriteLibrary.getSprite("logo_glo"),(n=createBitmap(e)).regX=-200,n.regY=-500,n.visible=!1,i.addChild(n),t=s_oSpriteLibrary.getSprite("logo_glogames"),(a=createBitmap(t)).regX=-200,a.regY=-500,a.visible=!1,i.addChild(a),this.animationLogo()},this.animationLogo=function(){createjs.Tween.get(n).to({alpha:0},0).call(function(){createjs.Tween.get(a).to({alpha:0},0).call(function(){createjs.Tween.get(n).to({alpha:1,visible:!0},250).wait(1e3).to({alpha:0,visible:!1},250).call(function(){createjs.Tween.get(a).to({alpha:1,visible:!0},250).wait(1e3).to({alpha:0,visible:!1},250).call(function(){s_oStage.removeAllChildren(),s_oMain.gotoMenu()})})})})},this._init()}function CTextButton(e,t,i,n,a,s,o,r){var _,l,c,h,u,d,T,S,E,p,g=r;this._init=function(e,t,i,n,a,s,o){_=!1,l=1,c=new Array,h=new Array,p=createBitmap(i),i.width,i.height,(S=new createjs.Container).x=e,S.y=t,S.regX=i.width/2,S.regY=i.height/2,s_bMobile||(S.cursor="pointer"),S.addChild(p,E),g.addChild(S),E=new CTLText(S,40,0,i.width-80,i.height,o,"center",s,a,1,2,2,n,!0,!0,!1,!1),this._initListener()},this.unload=function(){S.off("mousedown",u),S.off("pressup",d),g.removeChild(S)},this.setVisible=function(e){S.visible=e},this.setAlign=function(e){E.textAlign=e},this.setTextX=function(e){E.x=e},this.setScale=function(e){S.scaleX=S.scaleY=e,l=e},this.enable=function(){_=!1},this.disable=function(){_=!0},this._initListener=function(){u=S.on("mousedown",this.buttonDown),d=S.on("pressup",this.buttonRelease)},this.addEventListener=function(e,t,i){c[e]=t,h[e]=i},this.addEventListenerWithParams=function(e,t,i,n){c[e]=t,h[e]=i,T=n},this.buttonRelease=function(){_||(playSound("click",1,!1),S.scaleX=l,S.scaleY=l,c[ON_MOUSE_UP]&&c[ON_MOUSE_UP].call(h[ON_MOUSE_UP],T))},this.buttonDown=function(){_||(S.scaleX=.9*l,S.scaleY=.9*l,c[ON_MOUSE_DOWN]&&c[ON_MOUSE_DOWN].call(h[ON_MOUSE_DOWN]))},this.setPosition=function(e,t){S.x=e,S.y=t},this.tweenPosition=function(e,t,i,n,a,s,o){createjs.Tween.get(S).wait(n).to({x:e,y:t},i,a).call(function(){void 0!==s&&s.call(o)})},this.changeText=function(e){E.refreshText(e)},this.setX=function(e){S.x=e},this.setY=function(e){S.y=e},this.getButtonImage=function(){return S},this.getX=function(){return S.x},this.getY=function(){return S.y},this.getSprite=function(){return S},this.getScale=function(){return S.scaleX},this._init(e,t,i,n,a,s,o)}function CToggle(e,t,i,n,a){var s,o,r,_,l,c,h=a;this._init=function(e,t,i,n){o=new Array,r=new Array;var a={images:[i],frames:{width:i.width/2,height:i.height,regX:i.width/2/2,regY:i.height/2},animations:{state_true:[0],state_false:[1]}},_=new createjs.SpriteSheet(a);s=n,(c=createSprite(_,"state_"+s,i.width/2/2,i.height/2,i.width/2,i.height)).x=e,c.y=t,c.stop(),c.cursor="pointer",h.addChild(c),this._initListener()},this.unload=function(){c.off("mousedown",_),c.off("pressup",l),h.removeChild(c)},this._initListener=function(){_=c.on("mousedown",this.buttonDown),l=c.on("pressup",this.buttonRelease)},this.addEventListener=function(e,t,i){o[e]=t,r[e]=i},this.setActive=function(e){s=e,c.gotoAndStop("state_"+s)},this.buttonRelease=function(){c.scaleX=1,c.scaleY=1,playSound("click",1,!1),s=!s,c.gotoAndStop("state_"+s),o[ON_MOUSE_UP]&&o[ON_MOUSE_UP].call(r[ON_MOUSE_UP],s)},this.buttonDown=function(){c.scaleX=.9,c.scaleY=.9,o[ON_MOUSE_DOWN]&&o[ON_MOUSE_DOWN].call(r[ON_MOUSE_DOWN])},this.setPosition=function(e,t){c.x=e,c.y=t},this._init(e,t,i,n)}var EASE_LINEAR=0,EASE_CUBIC_IN=1,EASE_QUART_BACKIN=2,EASE_BACKIN=3,EASE_CUBIC_OUT=4,EASE_ELASTIC_OUT=5,EASE_BACKOUT=6;function CTweenController(){this.tweenValue=function(e,t,i){return e+i*(t-e)},this.easeLinear=function(e,t,i,n){return i*e/n+t},this.easeInCubic=function(e,t,i,n){return t+i*((e/=n)*e*e)},this.easeBackInQuart=function(e,t,i,n){var a=(e/=n)*e;return t+i*(2*a*a+2*(a*e)+-3*a)},this.easeInBack=function(e,t,i,n){return i*(e/=n)*e*(2.70158*e-1.70158)+t},this.easeOutCubic=function(e,t,i,n){return i*((e=e/n-1)*e*e+1)+t},this.easeOutElastic=function(e,t,i,n){var a,s;return 0===e?t:1==(e/=n)?t+i:(a=(s=.3*n)/4,i*Math.pow(2,-10*e)*Math.sin((e*n-a)*(2*Math.PI)/s)+i+t)},this.easeOutBack=function(e,t,i,n){var a=1.70158;return i*((e=e/n-1)*e*((a+1)*e+a)+1)+t}}function CVector2(){var e,t;this._init=function(){e=0,t=0},this.add=function(i){e+=i.getX(),t+=i.getY()},this.scalarDivision=function(i){e/=i,t/=i},this.subtract=function(i){e-=i.getX(),t-=i.getY()},this.scalarProduct=function(i){e*=i,t*=i},this.invert=function(){e*=-1,t*=-1},this.dotProduct=function(i){return e*i.getX()+t*i.getY()},this.set=function(i,n){e=i,t=n},this.setV=function(i){e=i.getX(),t=i.getY()},this.setY=function(e){t=e},this.length=function(){return Math.sqrt(e*e+t*t)},this.length2=function(){return e*e+t*t},this.normalize=function(){var i=this.length();i>0&&(e/=i,t/=i)},this.getNormalize=function(i){this.length();i.set(e,t),i.normalize()},this.rot90CCW=function(){var i=e;e=-t,t=i},this.rot90CW=function(){var i=e;e=t,t=-i},this.getRotCCW=function(i){i.set(e,t),i.rot90CCW()},this.getRotCW=function(i){i.set(e,t),i.rot90CW()},this.ceil=function(){e=Math.ceil(e),t=Math.ceil(t)},this.round=function(){e=Math.round(e),t=Math.round(t)},this.getX=function(){return e},this.getY=function(){return t},this._init()}function CWinPanel(e,t){var i,n,a,s;this._init=function(e,t){(a=new createjs.Container).alpha=0,a.x=e,a.y=t,s_oStage.addChild(a);var s,o,r,_,l=s_oSpriteLibrary.getSprite("msg_box"),c=createBitmap(l);a.addChild(c),new CTLText(a,(r=CANVAS_WIDTH/2)-(s=500)/2,(_=820)-(o=90)/2,s,o,80,"center","#B11821",FONT_GAME,1,2,2,TEXT_WIN,!0,!0,!0,!1).setOutline(4),new CTLText(a,r-s/2,_-o/2,s,o,80,"center","#FFFFFF",FONT_GAME,1,2,2,TEXT_WIN,!0,!0,!0,!1),(i=new CTLText(a,(r=CANVAS_WIDTH/2)-(s=500)/2,(_=1020)-(o=250)/2,s,o,100,"center","#B11821",FONT_GAME,1,2,2,TEXT_SCORE+":\n0",!0,!0,!0,!1)).setOutline(4),n=new CTLText(a,r-s/2,_-o/2,s,o,100,"center","#FFFFFF",FONT_GAME,1,2,2,TEXT_SCORE+":\n0",!0,!0,!0,!1),new CGfxButton(CANVAS_WIDTH/2,1340,s_oSpriteLibrary.getSprite("but_play"),a).addEventListener(ON_MOUSE_UP,this._onButBackHomeRelease,this)},this.unload=function(){},this.show=function(e){s=e,n.refreshText(TEXT_SCORE+":\n"+e),i.refreshText(TEXT_SCORE+":\n"+e),createjs.Tween.get(a).to({alpha:1},500),setVolume("soundtrack",1)},this.hide=function(){a.visible=!1},this._onButBackHomeRelease=function(){new CInputPanel(0,0).show(s)},this.onButPlayAgainRelease=function(){a.alpha=0,s_oGame.unload(),s_oMain.gotoGame()},this.isVisible=function(){return 0!==a.alpha},this._init(e,t)}